<link rel="stylesheet" href="style.css">
<pre>
type loc = {
  (* filename: string; *)
  line: int;
  line_start: int;
  offset: int;
}

let <a class="def" title="New string ref (93)" id="93" href="#93" style="color: #0000d9">filename<span class="id">@93</span></a> = <a class="ext" title="Pervasives.ref" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALref">ref</a> ""

let <a class="def" title="New int -> string array -> loc (116)" id="116" href="#116" style="color: #3db6f2">parse_loc<span class="id">@116</span></a> <a class="def" title="New int (126)" id="126" href="#126" style="color: #993d00">offset<span class="id">@126</span></a> <a class="def" title="New string array (133)" id="133" href="#133" style="color: #660036">a<span class="id">@133</span></a> =
  if <a class="ext" title="Pervasives.( ! )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( ! )">!</a><a class="ref" title="string ref (93)" id="93" href="#93" style="color: #0000d9">filename<span class="id">@93</span></a> <a class="ext" title="Pervasives.( = )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( = )">=</a> "" then (
    let <a class="def" title="New string (172)" id="172" href="#172" style="color: #b086b3">s<span class="id">@172</span></a> = <a class="ref" title="string array (133)" id="133" href="#133" style="color: #660036">a<span class="id">@133</span></a>.(<a class="ref" title="int (126)" id="126" href="#126" style="color: #993d00">offset<span class="id">@126</span></a>) in
    <a class="ref" title="string ref (93)" id="93" href="#93" style="color: #0000d9">filename<span class="id">@93</span></a> <a class="ext" title="Pervasives.( := )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( := )">:=</a> <a class="ext" title="String.sub" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/String.html#VALsub">String.sub</a> <a class="ref" title="string (172)" id="172" href="#172" style="color: #b086b3">s<span class="id">@172</span></a> 1 (<a class="ext" title="String.length" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/String.html#VALlength">String.length</a> <a class="ref" title="string (172)" id="172" href="#172" style="color: #b086b3">s<span class="id">@172</span></a> <a class="ext" title="Pervasives.( - )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( - )">-</a> 2)
  );
  {
    line = <a class="ext" title="Pervasives.int_of_string" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALint_of_string">int_of_string</a> <a class="ref" title="string array (133)" id="133" href="#133" style="color: #660036">a<span class="id">@133</span></a>.(<a class="ref" title="int (126)" id="126" href="#126" style="color: #993d00">offset<span class="id">@126</span></a> <a class="ext" title="Pervasives.( + )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( + )">+</a> 1);
    line_start = <a class="ext" title="Pervasives.int_of_string" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALint_of_string">int_of_string</a> <a class="ref" title="string array (133)" id="133" href="#133" style="color: #660036">a<span class="id">@133</span></a>.(<a class="ref" title="int (126)" id="126" href="#126" style="color: #993d00">offset<span class="id">@126</span></a> <a class="ext" title="Pervasives.( + )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( + )">+</a> 2);
    offset = <a class="ext" title="Pervasives.int_of_string" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALint_of_string">int_of_string</a> <a class="ref" title="string array (133)" id="133" href="#133" style="color: #660036">a<span class="id">@133</span></a>.(<a class="ref" title="int (126)" id="126" href="#126" style="color: #993d00">offset<span class="id">@126</span></a> <a class="ext" title="Pervasives.( + )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( + )">+</a> 3);
  }

let <a class="def" title="New int -> string array -> loc * loc (392)" id="392" href="#392" style="color: #f23d9d">parse_location<span class="id">@392</span></a> <a class="def" title="New int (407)" id="407" href="#407" style="color: #341d73">offset<span class="id">@407</span></a> <a class="def" title="New string array (414)" id="414" href="#414" style="color: #005266">a<span class="id">@414</span></a> =
  <a class="ref" title="int -> string array -> loc (116)" id="116" href="#116" style="color: #3db6f2">parse_loc<span class="id">@116</span></a> <a class="ref" title="int (407)" id="407" href="#407" style="color: #341d73">offset<span class="id">@407</span></a> <a class="ref" title="string array (414)" id="414" href="#414" style="color: #005266">a<span class="id">@414</span></a>, <a class="ref" title="int -> string array -> loc (116)" id="116" href="#116" style="color: #3db6f2">parse_loc<span class="id">@116</span></a> (<a class="ref" title="int (407)" id="407" href="#407" style="color: #341d73">offset<span class="id">@407</span></a> <a class="ext" title="Pervasives.( + )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( + )">+</a> 4) <a class="ref" title="string array (414)" id="414" href="#414" style="color: #005266">a<span class="id">@414</span></a>

let <a class="def" title="New unit -> string (470)" id="470" href="#470" style="color: #aa00ff">read_line<span class="id">@470</span></a> () =
  (*
  print_endline "l";
  *)
  <a class="ext" title="Pervasives.read_line" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALread_line">read_line</a> ()

let <a class="def" title="New unit -> string (536)" id="536" href="#536" style="color: #303840">read_block<span class="id">@536</span></a> () =
  let rec <a class="def" title="New string -> string (562)" id="562" href="#562" style="color: #d9c36c">f<span class="id">@562</span></a> <a class="def" title="New string (564)" id="564" href="#564" style="color: #9173e6">acc<span class="id">@564</span></a> =
    let <a class="def" title="New string (578)" id="578" href="#578" style="color: #7c8c69">l<span class="id">@578</span></a> = <a class="ref" title="unit -> string (470)" id="470" href="#470" style="color: #aa00ff">read_line<span class="id">@470</span></a> () in
    if <a class="ref" title="string (578)" id="578" href="#578" style="color: #7c8c69">l<span class="id">@578</span></a> <a class="ext" title="Pervasives.( = )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( = )">=</a> ")" then
      <a class="ref" title="string (564)" id="564" href="#564" style="color: #9173e6">acc<span class="id">@564</span></a>
    else
      let <a class="def" title="New string (647)" id="647" href="#647" style="color: #f23d9d">s<span class="id">@647</span></a> = <a class="ext" title="String.sub" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/String.html#VALsub">String.sub</a> <a class="ref" title="string (578)" id="578" href="#578" style="color: #7c8c69">l<span class="id">@578</span></a> 2 (<a class="ext" title="String.length" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/String.html#VALlength">String.length</a> <a class="ref" title="string (578)" id="578" href="#578" style="color: #7c8c69">l<span class="id">@578</span></a> <a class="ext" title="Pervasives.( - )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( - )">-</a> 2) in
      if <a class="ref" title="string (564)" id="564" href="#564" style="color: #9173e6">acc<span class="id">@564</span></a> <a class="ext" title="Pervasives.( = )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( = )">=</a> "" then
        <a class="ref" title="string -> string (562)" id="562" href="#562" style="color: #d9c36c">f<span class="id">@562</span></a> <a class="ref" title="string (647)" id="647" href="#647" style="color: #f23d9d">s<span class="id">@647</span></a>
      else
        (* FIXME hack to avoid replacing newlines afterwards *)
        (* this works because types are directly output as attributes *)
        <a class="ref" title="string -> string (562)" id="562" href="#562" style="color: #d9c36c">f<span class="id">@562</span></a> (<a class="ref" title="string (564)" id="564" href="#564" style="color: #9173e6">acc<span class="id">@564</span></a> <a class="ext" title="Pervasives.( ^ )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( ^ )">^</a> "&#xA;" <a class="ext" title="Pervasives.( ^ )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( ^ )">^</a> <a class="ref" title="string (647)" id="647" href="#647" style="color: #f23d9d">s<span class="id">@647</span></a>)
  in
  <a class="ref" title="string -> string (562)" id="562" href="#562" style="color: #d9c36c">f<span class="id">@562</span></a> ""

type ident =
  | Definition of string * (loc * loc)
  | Internal of string * (loc * loc)
  | External of string

let <a class="def" title="New string -> string array (1034)" id="1034" href="#1034" style="color: #3db6f2">split<span class="id">@1034</span></a> <a class="def" title="New string (1040)" id="1040" href="#1040" style="color: #ffd0bf">s<span class="id">@1040</span></a> =
  <a class="ext" title="Str.split" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Str.html#VALsplit">Str.split</a> (<a class="ext" title="Str.regexp_string" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Str.html#VALregexp_string">Str.regexp_string</a> " ") <a class="ref" title="string (1040)" id="1040" href="#1040" style="color: #ffd0bf">s<span class="id">@1040</span></a> <a class="ext" title="Pervasives.( |> )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( |> )">|></a>
  <a class="ext" title="Array.of_list" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Array.html#VALof_list">Array.of_list</a>

let <a class="def" title="New loc -> string -> ident (1106)" id="1106" href="#1106" style="color: #f23d9d">parse_ident<span class="id">@1106</span></a> <a class="def" title="New loc (1118)" id="1118" href="#1118" style="color: #d9364c">loc_start<span class="id">@1118</span></a> <a class="def" title="New string (1128)" id="1128" href="#1128" style="color: #005266">s<span class="id">@1128</span></a> =
  let <a class="def" title="New string array (1138)" id="1138" href="#1138" style="color: #d97b6c">a<span class="id">@1138</span></a> = <a class="ref" title="string -> string array (1034)" id="1034" href="#1034" style="color: #3db6f2">split<span class="id">@1034</span></a> <a class="ref" title="string (1128)" id="1128" href="#1128" style="color: #005266">s<span class="id">@1128</span></a> in
  if <a class="ref" title="string array (1138)" id="1138" href="#1138" style="color: #d97b6c">a<span class="id">@1138</span></a>.(0) <a class="ext" title="Pervasives.( = )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( = )">=</a> "def" then
    (* let's replace the start position *)
    (* FIXME how bad is the original one? *)
    let _, <a class="def" title="New loc (1276)" id="1276" href="#1276" style="color: #d9c36c">loc_end<span class="id">@1276</span></a> = <a class="ref" title="int -> string array -> loc * loc (392)" id="392" href="#392" style="color: #f23d9d">parse_location<span class="id">@392</span></a> 2 <a class="ref" title="string array (1138)" id="1138" href="#1138" style="color: #d97b6c">a<span class="id">@1138</span></a> in
    Definition (<a class="ref" title="string array (1138)" id="1138" href="#1138" style="color: #d97b6c">a<span class="id">@1138</span></a>.(1), (<a class="ref" title="loc (1118)" id="1118" href="#1118" style="color: #d9364c">loc_start<span class="id">@1118</span></a>, <a class="ref" title="loc (1276)" id="1276" href="#1276" style="color: #d9c36c">loc_end<span class="id">@1276</span></a>))
  else if <a class="ref" title="string array (1138)" id="1138" href="#1138" style="color: #d97b6c">a<span class="id">@1138</span></a>.(0) <a class="ext" title="Pervasives.( = )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( = )">=</a> "ext_ref" then
    (* don't break with Pervasives.( * ) *)
    External (<a class="ext" title="String.sub" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/String.html#VALsub">String.sub</a> <a class="ref" title="string (1128)" id="1128" href="#1128" style="color: #005266">s<span class="id">@1128</span></a> 8 (<a class="ext" title="String.length" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/String.html#VALlength">String.length</a> <a class="ref" title="string (1128)" id="1128" href="#1128" style="color: #005266">s<span class="id">@1128</span></a> <a class="ext" title="Pervasives.( - )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( - )">-</a> 8))
  else if <a class="ref" title="string array (1138)" id="1138" href="#1138" style="color: #d97b6c">a<span class="id">@1138</span></a>.(0) <a class="ext" title="Pervasives.( = )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( = )">=</a> "int_ref" then
    Internal (<a class="ref" title="string array (1138)" id="1138" href="#1138" style="color: #d97b6c">a<span class="id">@1138</span></a>.(1), <a class="ref" title="int -> string array -> loc * loc (392)" id="392" href="#392" style="color: #f23d9d">parse_location<span class="id">@392</span></a> 2 <a class="ref" title="string array (1138)" id="1138" href="#1138" style="color: #d97b6c">a<span class="id">@1138</span></a>)
  else
    <a class="ext" title="Pervasives.failwith" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALfailwith">failwith</a> ("unexpected " <a class="ext" title="Pervasives.( ^ )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( ^ )">^</a> <a class="ref" title="string array (1138)" id="1138" href="#1138" style="color: #d97b6c">a<span class="id">@1138</span></a>.(0))

let <a class="def" title="New ident -> string (1605)" id="1605" href="#1605" style="color: #993d00">link_of_ident<span class="id">@1605</span></a> <a class="def" title="New ident (1619)" id="1619" href="#1619" style="color: #bfd0ff">id<span class="id">@1619</span></a> =
  let <a class="def" title="New int -> string (1630)" id="1630" href="#1630" style="color: #00b3bf">anchor_of_id<span class="id">@1630</span></a> <a class="def" title="New int (1643)" id="1643" href="#1643" style="color: #aa00ff">id<span class="id">@1643</span></a> = "#" <a class="ext" title="Pervasives.( ^ )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( ^ )">^</a> <a class="ext" title="Pervasives.string_of_int" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALstring_of_int">string_of_int</a> <a class="ref" title="int (1643)" id="1643" href="#1643" style="color: #aa00ff">id<span class="id">@1643</span></a> in
  match <a class="ref" title="ident (1619)" id="1619" href="#1619" style="color: #bfd0ff">id<span class="id">@1619</span></a> with
  | Internal (_, ({<a class="def" title="New int (1709)" id="1709" href="#1709" style="color: #303840">offset<span class="id">@1709</span></a>; _}, _)) -> <a class="ref" title="int -> string (1630)" id="1630" href="#1630" style="color: #00b3bf">anchor_of_id<span class="id">@1630</span></a> <a class="ref" title="int (1709)" id="1709" href="#1709" style="color: #303840">offset<span class="id">@1709</span></a>
  | Definition (_, ({<a class="def" title="New int (1769)" id="1769" href="#1769" style="color: #f23d9d">offset<span class="id">@1769</span></a>; _}, _)) -> <a class="ref" title="int -> string (1630)" id="1630" href="#1630" style="color: #00b3bf">anchor_of_id<span class="id">@1630</span></a> <a class="ref" title="int (1769)" id="1769" href="#1769" style="color: #f23d9d">offset<span class="id">@1769</span></a>
  | External <a class="def" title="New string (1821)" id="1821" href="#1821" style="color: #664e33">name<span class="id">@1821</span></a> ->
    let <a class="def" title="New int (1837)" id="1837" href="#1837" style="color: #d9c36c">p<span class="id">@1837</span></a> = <a class="ext" title="String.index" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/String.html#VALindex">String.index</a> <a class="ref" title="string (1821)" id="1821" href="#1821" style="color: #664e33">name<span class="id">@1821</span></a> '.' in
    let <a class="def" title="New string (1874)" id="1874" href="#1874" style="color: #bfd0ff">modl<span class="id">@1874</span></a> = <a class="ext" title="String.sub" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/String.html#VALsub">String.sub</a> <a class="ref" title="string (1821)" id="1821" href="#1821" style="color: #664e33">name<span class="id">@1821</span></a> 0 <a class="ref" title="int (1837)" id="1837" href="#1837" style="color: #d9c36c">p<span class="id">@1837</span></a> in
    let <a class="def" title="New string (1912)" id="1912" href="#1912" style="color: #1a661a">mem<span class="id">@1912</span></a> = <a class="ext" title="String.sub" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/String.html#VALsub">String.sub</a> <a class="ref" title="string (1821)" id="1821" href="#1821" style="color: #664e33">name<span class="id">@1821</span></a> (<a class="ref" title="int (1837)" id="1837" href="#1837" style="color: #d9c36c">p<span class="id">@1837</span></a><a class="ext" title="Pervasives.( + )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( + )">+</a>1) (<a class="ext" title="String.length" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/String.html#VALlength">String.length</a> <a class="ref" title="string (1821)" id="1821" href="#1821" style="color: #664e33">name<span class="id">@1821</span></a> <a class="ext" title="Pervasives.( - )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( - )">-</a> <a class="ref" title="int (1837)" id="1837" href="#1837" style="color: #d9c36c">p<span class="id">@1837</span></a> <a class="ext" title="Pervasives.( - )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( - )">-</a> 1) in
    let <a class="def" title="New string (1980)" id="1980" href="#1980" style="color: #0000d9">base<span class="id">@1980</span></a> = "https://caml.inria.fr/pub/docs/manual-ocaml/libref/" in
    <a class="ref" title="string (1980)" id="1980" href="#1980" style="color: #0000d9">base<span class="id">@1980</span></a> <a class="ext" title="Pervasives.( ^ )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( ^ )">^</a> <a class="ref" title="string (1874)" id="1874" href="#1874" style="color: #bfd0ff">modl<span class="id">@1874</span></a> <a class="ext" title="Pervasives.( ^ )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( ^ )">^</a> ".html#VAL" <a class="ext" title="Pervasives.( ^ )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( ^ )">^</a> <a class="ref" title="string (1912)" id="1912" href="#1912" style="color: #1a661a">mem<span class="id">@1912</span></a>

type t = {
  location: loc * loc;
  typ: string;
  ident: ident;
}

let <a class="def" title="New unit -> string * t list (2153)" id="2153" href="#2153" style="color: #aa00ff">parse<span class="id">@2153</span></a> () =
  let rec <a class="def" title="New t list ->&#xA;[> `Ident of (loc * loc) * string | `Loc | `Type of loc * loc ] -> t list (2174)" id="2174" href="#2174" style="color: #d98d36">f<span class="id">@2174</span></a> <a class="def" title="New t list (2176)" id="2176" href="#2176" style="color: #566273">l<span class="id">@2176</span></a> <a class="def" title="New [> `Ident of (loc * loc) * string | `Loc | `Type of loc * loc ] as 'a (2178)" id="2178" href="#2178" style="color: #664e33">state<span class="id">@2178</span></a> =
    try
      match <a class="ref" title="unit -> string (470)" id="470" href="#470" style="color: #aa00ff">read_line<span class="id">@470</span></a> (), <a class="ref" title="'a (2178)" id="2178" href="#2178" style="color: #664e33">state<span class="id">@2178</span></a> with
      | "ident(", `Ident (<a class="def" title="New loc * loc (2257)" id="2257" href="#2257" style="color: #669900">location<span class="id">@2257</span></a>, <a class="def" title="New string (2267)" id="2267" href="#2267" style="color: #ff40f2">typ<span class="id">@2267</span></a>) ->
        let <a class="def" title="New loc (2287)" id="2287" href="#2287" style="color: #a67c87">loc_start<span class="id">@2287</span></a>, _ = <a class="ref" title="loc * loc (2257)" id="2257" href="#2257" style="color: #669900">location<span class="id">@2257</span></a> in
        let <a class="def" title="New ident (2326)" id="2326" href="#2326" style="color: #660036">ident<span class="id">@2326</span></a> = <a class="ref" title="loc -> string -> ident (1106)" id="1106" href="#1106" style="color: #f23d9d">parse_ident<span class="id">@1106</span></a> <a class="ref" title="loc (2287)" id="2287" href="#2287" style="color: #a67c87">loc_start<span class="id">@2287</span></a> (<a class="ref" title="unit -> string (536)" id="536" href="#536" style="color: #303840">read_block<span class="id">@536</span></a> ()) in
        <a class="ref" title="t list -> 'a -> t list (2174)" id="2174" href="#2174" style="color: #d98d36">f<span class="id">@2174</span></a> ({<a class="ref" title="loc * loc (2257)" id="2257" href="#2257" style="color: #669900">location<span class="id">@2257</span></a>; <a class="ref" title="string (2267)" id="2267" href="#2267" style="color: #ff40f2">typ<span class="id">@2267</span></a>; <a class="ref" title="ident (2326)" id="2326" href="#2326" style="color: #660036">ident<span class="id">@2326</span></a>} :: <a class="ref" title="t list (2176)" id="2176" href="#2176" style="color: #566273">l<span class="id">@2176</span></a>) `Loc
      | "type(", (`Ident _ as id) ->
        <a class="ext" title="Pervasives.ignore" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALignore">ignore</a> (<a class="ref" title="unit -> string (536)" id="536" href="#536" style="color: #303840">read_block<span class="id">@536</span></a> ());
        <a class="ref" title="t list -> 'a -> t list (2174)" id="2174" href="#2174" style="color: #d98d36">f<span class="id">@2174</span></a> <a class="ref" title="t list (2176)" id="2176" href="#2176" style="color: #566273">l<span class="id">@2176</span></a> <a class="ref" title="'a (2437)" id="2437" href="#2437" style="color: #d9c7a3">id<span class="id">@2437</span></a>
      | <a class="def" title="New string (2512)" id="2512" href="#2512" style="color: #669900">s<span class="id">@2512</span></a>, `Ident _
      | <a class="def" title="New string (2532)" id="2532" href="#2532" style="color: #b6f2ce">s<span class="id">@2532</span></a>, `Loc ->
        <a class="ref" title="t list -> 'a -> t list (2174)" id="2174" href="#2174" style="color: #d98d36">f<span class="id">@2174</span></a> <a class="ref" title="t list (2176)" id="2176" href="#2176" style="color: #566273">l<span class="id">@2176</span></a> (`Type (<a class="ref" title="int -> string array -> loc * loc (392)" id="392" href="#392" style="color: #f23d9d">parse_location<span class="id">@392</span></a> 0 (<a class="ref" title="string -> string array (1034)" id="1034" href="#1034" style="color: #3db6f2">split<span class="id">@1034</span></a> <a class="ref" title="string (2512)" id="2512" href="#2512" style="color: #669900">s<span class="id">@2512</span></a>)))
      | "type(", `Type <a class="def" title="New loc * loc (2615)" id="2615" href="#2615" style="color: #3db6f2">location<span class="id">@2615</span></a> ->
        <a class="ref" title="t list -> 'a -> t list (2174)" id="2174" href="#2174" style="color: #d98d36">f<span class="id">@2174</span></a> <a class="ref" title="t list (2176)" id="2176" href="#2176" style="color: #566273">l<span class="id">@2176</span></a> (`Ident (<a class="ref" title="loc * loc (2615)" id="2615" href="#2615" style="color: #3db6f2">location<span class="id">@2615</span></a>, <a class="ref" title="unit -> string (536)" id="536" href="#536" style="color: #303840">read_block<span class="id">@536</span></a> ()))
      | "ident(", `Type _ ->
        <a class="ext" title="Pervasives.ignore" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALignore">ignore</a> (<a class="ref" title="unit -> string (536)" id="536" href="#536" style="color: #303840">read_block<span class="id">@536</span></a> ());
        <a class="ref" title="t list -> 'a -> t list (2174)" id="2174" href="#2174" style="color: #d98d36">f<span class="id">@2174</span></a> <a class="ref" title="t list (2176)" id="2176" href="#2176" style="color: #566273">l<span class="id">@2176</span></a> `Loc
      | "call(", (`Type _ as t) ->
        <a class="ext" title="Pervasives.ignore" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALignore">ignore</a> (<a class="ref" title="unit -> string (536)" id="536" href="#536" style="color: #303840">read_block<span class="id">@536</span></a> ());
        <a class="ref" title="t list -> 'a -> t list (2174)" id="2174" href="#2174" style="color: #d98d36">f<span class="id">@2174</span></a> <a class="ref" title="t list (2176)" id="2176" href="#2176" style="color: #566273">l<span class="id">@2176</span></a> <a class="ref" title="'a (2769)" id="2769" href="#2769" style="color: #554359">t<span class="id">@2769</span></a>
      | <a class="def" title="New string (2841)" id="2841" href="#2841" style="color: #664e33">l<span class="id">@2841</span></a>, _ ->
        (*
        let s =
          match s with
          | `Loc -> "Loc"
          | `Type _ -> "Type"
          | `Ident _ -> "Ident"
        in
        failwith ("in state " ^ s ^ ", unexpected " ^ l)
        *)
        <a class="ext" title="Pervasives.failwith" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALfailwith">failwith</a> ("unexpected " <a class="ext" title="Pervasives.( ^ )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( ^ )">^</a> <a class="ref" title="string (2841)" id="2841" href="#2841" style="color: #664e33">l<span class="id">@2841</span></a>)
    with End_of_file ->
      <a class="ext" title="List.rev" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/List.html#VALrev">List.rev</a> <a class="ref" title="t list (2176)" id="2176" href="#2176" style="color: #566273">l<span class="id">@2176</span></a>
  in
  <a class="ext" title="Pervasives.( ! )" href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VAL( ! )">!</a><a class="ref" title="string ref (93)" id="93" href="#93" style="color: #0000d9">filename<span class="id">@93</span></a>, <a class="ref" title="t list ->&#xA;_[> `Ident of (loc * loc) * string | `Loc | `Type of loc * loc ] -> t list (2174)" id="2174" href="#2174" style="color: #d98d36">f<span class="id">@2174</span></a> [] `Loc
</pre>
